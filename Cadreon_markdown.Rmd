---
title: "Cadreon R Test"
author: "Anna Andrianatou"
date: "27/04/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(ggplot2)
library(tidyr)
salesData = read_excel("toy_sales_data.xlsx", sheet=1)
attach(salesData)

#Change to tidy-data:
tidySales = gather(salesData,  "Type", "Amount", 2:4)
```

## The test

This is a R test given by Cadreon. It explores the sales of a toy brand across two years. 

## Question 2
A plot of sales, TV and digital investment is below. There does not appear to be any time trend in sales, except for a positive linear growth. The behaviour of sales does appear positively correlated with both TV investment and Digital investment. 

```{r q2, echo=FALSE}
ggplot(data= tidySales, aes(x=month, y=Amount/10^6, colour=Type))+
  geom_point()+
  geom_line()+
  ggtitle("Sales, TV investment and Digital investment vs. Time")+
  xlab("Time")+
  ylab("Amount ($ million) ")
```

## Question 3
A correlation matrix between sales, TV investment and digital investment is given below.
```{r q3, echo=FALSE}
cor(salesData[,2:4])
```
Sales is positively correlated with both types of investment. TV spending and digital spending do have some positive correlation, however is fairly small. Unlikely to cause a multicolinearity problem. 

##Question 4 a,b
The month variable in R converts to an integer and represents time in seconds (the spacing between each month is different due to the different number of days in various months). The trend variable is an indicator for each month. We are only really interested in the monthly trend and so the "trend" variable is included and "month" omitted. 


```{r q4, echo=FALSE}
#fitting a linear regression model to the data: use all data points
salesRegression = lm(sales ~ tv_spend + digital_spend + trend + xmas)
plot(salesRegression) #assumptions of linear regression appear to check out (random, normally dist errors)
summary(salesRegression)
```
The adjusted R squared (adjusted for the number of variables in the model) is 0.8984. Therefore, approximately 90% of the variation in the sales data is explained by the model. \newline \newline

Assume a level of significance of 5%:\newline \newline
TV spend regressor has an associated p-value of 2.58e-06 (<0.05) and therefore there is statisitcally significant in the model (coefficient $\neq$ 0). \newline \newline
Digital spend regressor has an associated p-value of 1.07e-05 and therefore there is statisitcally significant in the model (coefficient $\neq$ 0). \newline \newline
Trend has an associated p-value of 1.44e-06 and therefore there is statisitcally significant in the model (coefficient $\neq$ 0). There is some growth over time. \newline \newline
xmas has an associated p-value of 0.00711 and therefore there is statisitcally significant in the model (coefficient $\neq$ 0). X-mas effects sales positively.\newline \newline
## Question 5
From this regression, for every dollar in TV_spend, sales increase by $2.026

To find % change, fit a log-linear regression and interpret the coefficient of TV_spend
```{r q5, echo=FALSE}
logSalesRegression = lm(log(sales) ~ tv_spend + digital_spend + trend + xmas)
summary(logSalesRegression)
```
From this log-linear regression, for every dollar in TV_spend, sales increase by 0.00001957%. 
## Question 6
$ROI = (gains - investment cost)/investment cost$ (\$2.026 for every $1 in investment) 
```{r q6, echo=FALSE}
ROI = (2.026-1)/1*100   #102.6%
```

##Question 7
plug in the values to the regression
```{r q7, echo=FALSE}
plannedData = read_excel("toy_sales_data.xlsx", sheet=2)
plannedData$trend = c(25,26,27)  #continue the trend variable for the following months
plannedData$xmas = c(0,0,0)      #none of the prediction dates are xmas
predict.lm(salesRegression, plannedData)   #predicted sales
```
## Question 8
The purpose of the model is to observe the return to investment of TV and digital ads and to predict future sales. Therefore, any additional data that could explain sales would be beneficial to the model. This could include any other important events other than xmas that could increase the sales of toys, prices or sales of competing toy brands or subsitution items(such as video games), the number of stores selling the toy brand in each month.\newline \newline
It is important to capture the impact of effects other than the advertising campaign to ensure the impact of the ads are not over estimated.
